
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Preventing Duplicate Content | Rails SEO Tip - Micah Roberson</title>
  <meta name="author" content="Micah Roberson">

  
  <meta name="description" content="Canonicalization is the SEO concept of redirecting multiple URLs to a single master URL. Learn how to implement a solution in Ruby on Rails to &hellip;">
  <meta name="keywords" content="seo, duplicate content, ruby on rails, rails, canonicalization, multiple urls, preferred domain">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://micahroberson.github.com/preventing-duplicate-content">
  <link href="/favicon.ico" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Micah Roberson" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34306816-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<div style="
    position: fixed;
    width: 100%;
    height: 100%;
    left: 0;
    background: url(/images/desk.jpg) fixed center;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    z-index: -1;
"></div>
<div style="
    position: fixed;
    width: 100%;
    height: 100%;
    left: 0;
    background-color: rgba(255, 255, 255, 0.95);
    z-index: -1;
"></div>
<body id="skrollr-body"   class="no-sidebar"  >
  <header role="banner"><div class='navbar-wrapper' data-0="position:static;box-shadow:none;" data-top-top='position:fixed;top:0;left:0;box-shadow:0px 1px 1px rgba(0,0,0,0.2)'>
  <a href="/">
    <div class="logo" data-0="width:133px;height:133px;" data--200-top-top="width:50px;height:50px;" ><span></span></div>
  </a>
  <div class="intro">
    <h1>Micah Roberson</h1>
    <h2>Developer &amp; Entrepreneur</h2>
    <h4>San Francisco, California</h4>
    <span style='display:none'>By <a href='https://plus.google.com/106721416583632264667' rel='author'>Micah Roberson</a></span>
    <a class='social-media-link' href='https://twitter.com/micahroberson' target='_blank'><i class='icon-twitter'></i></a>
    <a class='social-media-link' href='https://www.github.com/micahroberson' target='_blank'><i class='icon-github'></i></a>
    <a class='social-media-link' href='/atom.xml' target='_blank'><i class='icon-feed'></i></a>
    <a class='social-media-link' href='mailto:micah.roberson@gmail.com' target='_blank'><i class='icon-mail'></i></a>
  </div>
</div>

</header>
  <nav role="navigation">
  

</nav>
  <footer class='fixed-footer'>
    <div class='social-links'>
    
<section>
	<form action="http://micahroberson.us7.list-manage.com/subscribe/post?u=604e31743665c33977d2efa00&amp;id=bf22667003" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank">
    <span>Get Fresh Content</span>
		<input type="text" placeholder="Your Email Here" autocomplete="off" name="EMAIL" id="mce-EMAIL">
		<button type="submit" name="subscribe" id="mc-embedded-subscribe">Subscribe</button>
	</form>
</section>


    </div>
  </footer>
  <div id="main">
    <div id="content" class="fadein">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <p class="meta">
        








  


<time datetime="2013-08-17T11:13:00-07:00" pubdate data-updated="true">Aug 17</time>
        
      </p>
    
    
      <h4 class="entry-title">Preventing Duplicate Content | Rails SEO Tip</h4>
    
  </header>


<div class="entry-content"><p>It&#8217;s useful to allow users to reach your site by visiting both the naked domain, greeksquare.com, as well as the www. prefixed version, www.greeksquare.com. However, this puts search engines in a sticky situation because from their perspective, these are two different sites with the same exact content. Fortunately, there&#8217;s a simple solution for site&#8217;s built with any Rack based web server(ie. Ruby on Rails, Sinatra, etc.): <a href="https://github.com/jtrupiano/rack-rewrite">rack-rewrite</a>. Rack-rewrite is a simple middleware for applying rewrite rules (redirects) and we&#8217;re going to use it to redirect a couple of prefixed domains to the naked domain. By pointing all variations of the same content to one place, we eliminate the competition between the different URLs, and also boost the overall relevancy and popularity.</p>

<p>For this example, I&#8217;m going to use some snippets from the main Rails app behind <a href="https://greeksquare.com">GreekSquare</a>. Let&#8217;s begin by adding the rack-rewrite gem:</p>

<pre><code>gem 'rack-rewrite'
</code></pre>

<p>Once the gem is installed, its as simple as adding some rules to production.rb. If you plan on having several rules, it would be best to put this in an initializer.</p>

<pre><code>config.middleware.insert_before(Rack::Lock, Rack::Rewrite) do
  r301 %r{.*}, 'http://greeksquare.com$&amp;', :if =&gt; Proc.new {|rack_env|
    rack_env['SERVER_NAME'] == 'www.greeksquare.com' || rack_env['SERVER_NAME'].include?('herokuapp')
  }
end
</code></pre>

<p>In this example I&#8217;m rewriting all &#8216;www.greeksquare.com&#8217; and &#8216;greeksquare.herokuapp.com&#8217; requests to simply be the naked domain &#8216;greeksquare.com&#8217;.  Also notice the redirect status code being used, r301, which indicates the site has &#8216;Moved Permanently&#8217;. More info on status codes <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">here</a>.</p>

<p>It&#8217;s also a good idea to make sure you set the Preferred domain in Google&#8217;s Webmaster Tools. It&#8217;s easy to get setup with Webmaster Tools, and once you do just visit the Site Settings page where you&#8217;ll find the form below:</p>

<p><img class="center" src="/images/preferred_url.png"></p>
</div>

  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Micah Roberson</span></span>

      








  


<time datetime="2013-08-17T11:13:00-07:00" pubdate data-updated="true">Aug 17</time>
      


    </p>
    
      <div class="sharing">
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/why-you-need-a-red-team/" title="Previous Post: Why You Need a Red Team">&laquo; Why You Need a Red Team</a>
      
      
    </p>
  </footer>
</article>

</div>


    </div>
  </div>
</body>
</html>
