
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Preventing Duplicate Content | Rails SEO Tip - Micah Roberson</title>
  <meta name="author" content="Micah Roberson">

  
  <meta name="description" content="Canonicalization is the SEO concept of redirecting multiple URLs to a single master URL. Learn how to implement a solution in Ruby on Rails to &hellip;">
  <meta name="keywords" content="seo, duplicate content, ruby on rails, rails, canonicalization, multiple urls, preferred domain">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta itemprop="image" content="http://micahroberson.com/images/micah-headshot-color-square.png">

  
  <link rel="canonical" href="http://micahroberson.com/preventing-duplicate-content">
  <link href="/favicon.ico" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Micah Roberson" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34306816-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <meta property="og:url" content="http://micahroberson.com/preventing-duplicate-content/">
<meta property="og:type" content="website" />

<meta property="og:title" content="Preventing Duplicate Content | Rails SEO Tip">
<meta property="og:description" content="Canonicalization is the SEO concept of redirecting multiple URLs to a single master URL. Learn how to implement a solution in Ruby on Rails to prevent duplicate content complications to improve your SEO.">
 
<meta property="og:image" content="http://micahroberson.com/images/logo_orange_14.png">
 

</head>

<body id="skrollr-body"   class="no-sidebar"  >
  
  <span itemscope itemtype="http://schema.org/Article">
  
  <header role="banner"><div class='navbar-wrapper shadow'>
  <a href="/">
    <div class="logo"></div>
    <div class="profile"></div>
    <span class="header-name" itemprop="author" itemscope itemtype="http://schema.org/Person">
      <span itemprop="name">Micah Roberson</span>
    </span>
    <span class="header-desc">Programmer & Entrepreneur in San Francisco</span>
  </a>
  <nav>
    <ul>
      <li class='hide-tablet'><a href='https://doozie.io?utm_source=micahroberson.com&utm_medium=navbar' target='_blank'><img src="/images/doozie_logo.png" style="max-width: 90px; margin-right: 40px; vertical-align: middle;"></a></li>
      <li class='hide-tablet'><a href='https://raddevelopment.io?utm_source=micahroberson.com&utm_medium=navbar' target='_blank'><img src="/images/RAD-logo-white-background.png" style="max-width: 70px;margin-right: 80px;vertical-align: middle;"></a></li>
      <li><a class='social-media-link' href='https://twitter.com/micahroberson' target='_blank'><i class='icon-twitter'></i></a></li>
      <li><a class='social-media-link' href='https://www.github.com/micahroberson' target='_blank'><i class='icon-github'></i></a></li>
      <li><a class='social-media-link' href='/atom.xml' target='_blank'><i class='icon-feed' style='margin-left:3px;'></i></a></li>
    </ul>
  </nav>
  <span style='display:none;'>By <a href='https://plus.google.com/106721416583632264667' rel='author'>Micah Roberson</a></span>
  <!-- <div class='social-links'>
    <a class='social-media-link' href='https://twitter.com/micahroberson' target='_blank'><i class='icon-twitter'></i></a>
    <a class='social-media-link' href='https://www.github.com/micahroberson' target='_blank'><i class='icon-github'></i></a>
    <a class='social-media-link' href='/atom.xml' target='_blank'><i class='icon-feed'></i></a>
    <a class='social-media-link' href='mailto:micah.roberson@gmail.com' target='_blank'><i class='icon-mail'></i></a>
  </div> -->
</div>
</header>
  <nav role="navigation">
  

</nav>
  <div id="main">
    
    <div id="content">
      <div>
<article class="hentry" role="article"  itemscope itemtype="http://schema.org/BlogPosting">
  
  <header>
    
      <h2 class="entry-title">
        Preventing Duplicate Content | Rails SEO Tip
        <!-- 
          <span style="float:right;margin-top:2px;">
            <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://micahroberson.com/preventing-duplicate-content/" data-via="micahroberson" data-counturl="http://micahroberson.com/preventing-duplicate-content/" >Tweet</a>
          </span>
         -->
      </h2>
      
        <p class="meta">
          








  <time datetime="2013-08-17T11:13:00-07:00" class="published" pubdate data-updated="true">Aug 17</time>


  <time style="display:none;" datetime="2013-08-17T11:13:00-07:00" class="updated">Aug 17</time>

          
        </p>
      
    
  </header>


<div class="entry-content" itemprop="articleBody"><p>It’s useful to allow users to reach your site by visiting both the naked domain, greeksquare.com, as well as the www. prefixed version, www.greeksquare.com. However, this puts search engines in a sticky situation because from their perspective, these are two different sites with the same exact content. Fortunately, there’s a simple solution for site’s built with any Rack based web server(ie. Ruby on Rails, Sinatra, etc.): <a href="https://github.com/jtrupiano/rack-rewrite">rack-rewrite</a>. Rack-rewrite is a simple middleware for applying rewrite rules (redirects) and we’re going to use it to redirect a couple of prefixed domains to the naked domain. By pointing all variations of the same content to one place, we eliminate the competition between the different URLs, and also boost the overall relevancy and popularity.
<!--more-->
For this example, I’m going to use some snippets from the main Rails app behind <a href="https://greeksquare.com">GreekSquare</a>. Let’s begin by adding the rack-rewrite gem:</p>

<pre><code>gem 'rack-rewrite'
</code></pre>

<p>Once the gem is installed, its as simple as adding some rules to production.rb. If you plan on having several rules, it would be best to put this in an initializer.</p>

<pre><code>config.middleware.insert_before(Rack::Lock, Rack::Rewrite) do
  r301 %r{.*}, 'http://greeksquare.com$&amp;', :if =&gt; Proc.new {|rack_env|
    rack_env['SERVER_NAME'] == 'www.greeksquare.com' || rack_env['SERVER_NAME'].include?('herokuapp')
  }
end
</code></pre>

<p>In this example I’m rewriting all ‘www.greeksquare.com’ and ‘greeksquare.herokuapp.com’ requests to simply be the naked domain ‘greeksquare.com’.  Also notice the redirect status code being used, r301, which indicates the site has ‘Moved Permanently’. More info on status codes <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">here</a>. </p>

<p>It’s also a good idea to make sure you set the Preferred domain in Google’s Webmaster Tools. It’s easy to get setup with Webmaster Tools, and once you do just visit the Site Settings page where you’ll find the form below:</p>

<p><img class="center" src="/images/preferred_url.png" /></p>
</div>

  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Micah Roberson</span></span>

      








  <time datetime="2013-08-17T11:13:00-07:00" class="published" pubdate data-updated="true">Aug 17</time>


  <time style="display:none;" datetime="2013-08-17T11:13:00-07:00" class="updated">Aug 17</time>

      


    </p>
    <!-- 
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://micahroberson.com/preventing-duplicate-content/" data-via="micahroberson" data-counturl="http://micahroberson.com/preventing-duplicate-content/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

     -->
    <p class="meta">
      
        <a class="basic-alignment left" href="/why-you-need-a-red-team/" title="Previous Post: Why You Need a Red Team">&laquo; Why You Need a Red Team</a>
      
      
        <a class="basic-alignment right" href="/saving-drag-and-drop-sort-position/" title="next Post: Saving Drag and Drop Sort Position">Saving Drag and Drop Sort Position &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <div id="disqus_thread" aria-live="polite">

<script type="text/javascript">
      var disqus_shortname = 'micahroberson';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://micahroberson.com/preventing-duplicate-content/';
        var disqus_url = 'http://micahroberson.com/preventing-duplicate-content/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>

</div>
  </section>

</div>


    </div>
  </div>
  
  </span>
  
</body>
</html>
